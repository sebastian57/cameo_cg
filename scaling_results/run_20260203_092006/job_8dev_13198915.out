============================================================
Module Environment
============================================================

============================================================
SLURM Job Configuration
============================================================
Config file:    config_timing_test.yaml
Job ID:         13198915
Nodes:          4
Tasks/node:     1 (1 process per node)
GPUs per node:  4 (pmap distributes across local GPUs)
Total GPUs:     16
CUDA_HOME:      /p/software/juwelsbooster/stages/2025/software/CUDA/12
CUDA_VISIBLE:   0
============================================================
Verifying GPU allocation per node...
Host=jwb0451.juwels CUDA_VISIBLE_DEVICES=0
GPU 0: NVIDIA A100-SXM4-40GB (UUID: GPU-bafc13ab-041a-fd27-892b-68290d996a16)
GPU 1: NVIDIA A100-SXM4-40GB (UUID: GPU-3cfe39d5-f85d-046b-76cc-af7ba192e9f1)
GPU 2: NVIDIA A100-SXM4-40GB (UUID: GPU-f0c82b91-241e-b36c-f5f0-fe196b34ccfc)
GPU 3: NVIDIA A100-SXM4-40GB (UUID: GPU-dfa5f2bb-7e87-7913-31eb-40ca89595ca0)
Host=jwb0452.juwels CUDA_VISIBLE_DEVICES=0
Host=jwb0453.juwels CUDA_VISIBLE_DEVICES=0
Host=jwb0470.juwels CUDA_VISIBLE_DEVICES=0
GPU 0: NVIDIA A100-SXM4-40GB (UUID: GPU-243d272c-e507-d4c6-6f76-f5d0c185d4bb)
GPU 1: NVIDIA A100-SXM4-40GB (UUID: GPU-8984e186-6bef-41f7-280d-cc2debab8d80)
GPU 2: NVIDIA A100-SXM4-40GB (UUID: GPU-2ea18cac-57b9-c1d5-78a5-0a1d905b6855)
GPU 3: NVIDIA A100-SXM4-40GB (UUID: GPU-383d7018-661c-f3c7-a273-90c66e6a3d07)
GPU 0: NVIDIA A100-SXM4-40GB (UUID: GPU-eff82b18-a81f-ea51-20dd-28ce716fdf73)
GPU 1: NVIDIA A100-SXM4-40GB (UUID: GPU-66e7686d-cd1f-b4dd-2d70-d06bed452a96)
GPU 2: NVIDIA A100-SXM4-40GB (UUID: GPU-5275ce63-8efc-57bc-31e3-17f6e57217d6)
GPU 3: NVIDIA A100-SXM4-40GB (UUID: GPU-84fbbbb9-45ac-9ca5-19f9-d62cb8a9f73c)
GPU 0: NVIDIA A100-SXM4-40GB (UUID: GPU-356bbb2c-8075-b422-ad71-04582b3ad546)
GPU 1: NVIDIA A100-SXM4-40GB (UUID: GPU-b053a033-2b3f-2711-5761-35f2c5f77684)
GPU 2: NVIDIA A100-SXM4-40GB (UUID: GPU-8f0a8241-3b21-2b79-a90a-b8350dd8b493)
GPU 3: NVIDIA A100-SXM4-40GB (UUID: GPU-a38960a3-92e9-2ea6-6971-813c510d5351)

============================================================
Multi-node JAX Distributed Verification
============================================================
Node=jwb0451.juwels SLURM_PROCID=0 SLURM_NTASKS=4
Node=jwb0453.juwels SLURM_PROCID=2 SLURM_NTASKS=4
Node=jwb0470.juwels SLURM_PROCID=3 SLURM_NTASKS=4
Node=jwb0452.juwels SLURM_PROCID=1 SLURM_NTASKS=4
JAX will auto-detect coordinator from SLURM environment
============================================================
Submit directory: /p/project1/cameo/schmidt36/chemtrain-deploy/external/chemtrain/clean_code_base
Training script:  /p/project1/cameo/schmidt36/chemtrain-deploy/external/chemtrain/clean_code_base/scripts/train.py
============================================================
Starting training with 4 node(s), 4 GPUs each...
Log file: train_allegro_13198915.log
============================================================
[Data] Resolved relative path: data_prep/datasets/2g4q4z5k_320K_kcalmol_1bead_notnorm_aggforce.npz -> /p/project1/cameo/schmidt36/chemtrain-deploy/external/chemtrain/clean_code_base/data_prep/datasets/2g4q4z5k_320K_kcalmol_1bead_notnorm_aggforce.npz
[Data] Resolved relative path: data_prep/datasets/2g4q4z5k_320K_kcalmol_1bead_notnorm_aggforce.npz -> /p/project1/cameo/schmidt36/chemtrain-deploy/external/chemtrain/clean_code_base/data_prep/datasets/2g4q4z5k_320K_kcalmol_1bead_notnorm_aggforce.npz
[Data] Resolved relative path: data_prep/datasets/2g4q4z5k_320K_kcalmol_1bead_notnorm_aggforce.npz -> /p/project1/cameo/schmidt36/chemtrain-deploy/external/chemtrain/clean_code_base/data_prep/datasets/2g4q4z5k_320K_kcalmol_1bead_notnorm_aggforce.npz
[Data] Resolved relative path: data_prep/datasets/2g4q4z5k_320K_kcalmol_1bead_notnorm_aggforce.npz -> /p/project1/cameo/schmidt36/chemtrain-deploy/external/chemtrain/clean_code_base/data_prep/datasets/2g4q4z5k_320K_kcalmol_1bead_notnorm_aggforce.npz
[Data] N_max: 99
[Data] N_max: 99
[Data] N_max: 99
[Data] N_max: 99
[Data] Species: [14 20 16 16 13 15  7 20 21 11 16  3  2 12  2  6  0 12  6 15 12  6  6  8
  5  3  0  1 16 12  0  7  7 10 17 12 11 16 14 12 13 12  1 12 11  1 16 17
 20 11 21  6 11 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
 -1 -1 -1]
[Data] Total frames: 10000
[Data] Species: [14 20 16 16 13 15  7 20 21 11 16  3  2 12  2  6  0 12  6 15 12  6  6  8
  5  3  0  1 16 12  0  7  7 10 17 12 11 16 14 12 13 12  1 12 11  1 16 17
 20 11 21  6 11 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
 -1 -1 -1]
[Data] Total frames: 10000
[Data] Species: [14 20 16 16 13 15  7 20 21 11 16  3  2 12  2  6  0 12  6 15 12  6  6  8
  5  3  0  1 16 12  0  7  7 10 17 12 11 16 14 12 13 12  1 12 11  1 16 17
 20 11 21  6 11 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
 -1 -1 -1]
[Data] Total frames: 10000
[Data] Species: [14 20 16 16 13 15  7 20 21 11 16  3  2 12  2  6  0 12  6 15 12  6  6  8
  5  3  0  1 16 12  0  7  7 10 17 12 11 16 14 12 13 12  1 12 11  1 16 17
 20 11 21  6 11 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
 -1 -1 -1]
[Data] Total frames: 10000
[Data] [Preprocessing] Computed box: [398.13    442.15002 444.7    ]
[Data] [Preprocessing] R_shift: [188.9     161.41    156.73001]
[Data] [Preprocessing] Computed box: [398.13    442.15002 444.7    ]
[Data] [Preprocessing] R_shift: [188.9     161.41    156.73001]
[Data] [Preprocessing] Computed box: [398.13    442.15002 444.7    ]
[Data] [Preprocessing] R_shift: [188.9     161.41    156.73001]
[Data] [Preprocessing] Computed box: [398.13    442.15002 444.7    ]
[Data] [Preprocessing] R_shift: [188.9     161.41    156.73001]
[Model] Using Allegro size: default
[Model] Using Allegro size: default
[Model] Using Allegro size: default
[Model] Using Allegro size: default
[Model] Detected 22 unique species
[Model] Using Allegro config size: default
[Model] Detected 22 unique species
[Model] Using Allegro config size: default
[Model] Detected 22 unique species
[Model] Using Allegro config size: default
[Model] Detected 22 unique species
[Model] Using Allegro config size: default
[Model] Mode: Prior + Allegro
[Model] Prior weights: {'bond': 0.5, 'angle': 0.25, 'dihedral': 0.25, 'repulsive': 1.0}
[Model] Initialized: CombinedModel(mode=Prior+Allegro, N_max=99)
[Data] [Split] Training: 8000, Validation: 2000
[Model] Mode: Prior + Allegro
[Model] Prior weights: {'bond': 0.5, 'angle': 0.25, 'dihedral': 0.25, 'repulsive': 1.0}
[Model] Initialized: CombinedModel(mode=Prior+Allegro, N_max=99)
[Data] [Split] Training: 8000, Validation: 2000
[Model] Mode: Prior + Allegro
[Model] Prior weights: {'bond': 0.5, 'angle': 0.25, 'dihedral': 0.25, 'repulsive': 1.0}
[Model] Initialized: CombinedModel(mode=Prior+Allegro, N_max=99)
[Data] [Split] Training: 8000, Validation: 2000
[Model] Mode: Prior + Allegro
[Model] Prior weights: {'bond': 0.5, 'angle': 0.25, 'dihedral': 0.25, 'repulsive': 1.0}
[Model] Initialized: CombinedModel(mode=Prior+Allegro, N_max=99)
[Data] [Split] Training: 8000, Validation: 2000
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=float32 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=float32 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=float32 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=float32 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=float32 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=float32 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=float32 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=float32 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/numpy/lax_numpy.py:183: UserWarning: Explicitly requested dtype float64 requested in asarray is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return asarray(x, dtype=self.dtype)
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/numpy/lax_numpy.py:183: UserWarning: Explicitly requested dtype float64 requested in asarray is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return asarray(x, dtype=self.dtype)
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/numpy/lax_numpy.py:183: UserWarning: Explicitly requested dtype float64 requested in asarray is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return asarray(x, dtype=self.dtype)
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/numpy/lax_numpy.py:183: UserWarning: Explicitly requested dtype float64 requested in asarray is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return asarray(x, dtype=self.dtype)
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/numpy/reductions.py:213: UserWarning: Explicitly requested dtype <class 'jax.numpy.float64'> requested in sum is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return _reduction(a, "sum", np.sum, lax.add, 0, preproc=_cast_to_numeric,
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/numpy/reductions.py:213: UserWarning: Explicitly requested dtype <class 'jax.numpy.float64'> requested in sum is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return _reduction(a, "sum", np.sum, lax.add, 0, preproc=_cast_to_numeric,
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/numpy/reductions.py:213: UserWarning: Explicitly requested dtype <class 'jax.numpy.float64'> requested in sum is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return _reduction(a, "sum", np.sum, lax.add, 0, preproc=_cast_to_numeric,
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/numpy/reductions.py:213: UserWarning: Explicitly requested dtype <class 'jax.numpy.float64'> requested in sum is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return _reduction(a, "sum", np.sum, lax.add, 0, preproc=_cast_to_numeric,
[Training] Initialized model with seed=8951
[Training] Applied NumpyDataLoader patch
[Training] 
============================================================
[Training] Prior Pre-Training (LBFGS, max_steps=200)
[Training] [Distributed] Running on rank 0, broadcasting to 4 processes
[Training] ============================================================
[Training] [LBFGS] Rank 3 waiting for broadcast from rank 0...
[Training] Initialized model with seed=8951
[Training] Applied NumpyDataLoader patch
[Training] Initialized model with seed=8951
[Training] Applied NumpyDataLoader patch
[Training] 
============================================================
[Training] Prior Pre-Training (LBFGS, max_steps=200)
[Training] [Distributed] Running on rank 0, broadcasting to 4 processes
[Training] 
============================================================
[Training] Prior Pre-Training (LBFGS, max_steps=200)
[Training] ============================================================
[Training] [Distributed] Running on rank 0, broadcasting to 4 processes
[Training] ============================================================
[Training] [LBFGS] Starting optimization on rank 0...
[Training] [LBFGS] Rank 1 waiting for broadcast from rank 0...
[Training] Initialized model with seed=8951
[Training] Applied NumpyDataLoader patch
[Training] 
============================================================
[Training] Prior Pre-Training (LBFGS, max_steps=200)
[Training] [Distributed] Running on rank 0, broadcasting to 4 processes
[Training] ============================================================
[Training] [LBFGS] Rank 2 waiting for broadcast from rank 0...
[Training] [LBFGS] Completed: 200 steps
[Training] [LBFGS] Final loss: 2.690230e+02
[Training] [LBFGS] Grad norm: 4.317502e+00 (tol=1.000000e-06)
[Training] [LBFGS] Converged: False
[Training] [LBFGS] Rank 0 received broadcasted parameters
[Training] 
[LBFGS] Fitted parameters:
[Training] [LBFGS] Rank 2 received broadcasted parameters
[Training] 
[LBFGS] Fitted parameters:
[Training] [LBFGS] Rank 3 received broadcasted parameters
[Training] 
[LBFGS] Fitted parameters:
[Training] [LBFGS] Rank 1 received broadcasted parameters
[Training] 
[LBFGS] Fitted parameters:
[Training]   a: [ 2.9519713 -3.53609   -2.4297097  0.684526   3.5104425  1.0899799
 -1.0728651 -4.284473  -1.0816767 -4.2213955]
[Training]   a: [ 2.9519713 -3.53609   -2.4297097  0.684526   3.5104425  1.0899799
 -1.0728651 -4.284473  -1.0816767 -4.2213955]
[Training]   a: [ 2.9519713 -3.53609   -2.4297097  0.684526   3.5104425  1.0899799
 -1.0728651 -4.284473  -1.0816767 -4.2213955]
[Training]   a: [ 2.9519713 -3.53609   -2.4297097  0.684526   3.5104425  1.0899799
 -1.0728651 -4.284473  -1.0816767 -4.2213955]
[Training]   b: [ 1.9049999  3.5169964 -3.0964851 -2.2731562 -1.0850918  3.6170297
  1.6139234  1.4530089 -4.830279  -3.2038846]
[Training]   epsilon: 1.004742
[Training]   b: [ 1.9049999  3.5169964 -3.0964851 -2.2731562 -1.0850918  3.6170297
  1.6139234  1.4530089 -4.830279  -3.2038846]
[Training]   epsilon: 1.004742
[Training]   b: [ 1.9049999  3.5169964 -3.0964851 -2.2731562 -1.0850918  3.6170297
  1.6139234  1.4530089 -4.830279  -3.2038846]
[Training]   epsilon: 1.004742
[Training]   b: [ 1.9049999  3.5169964 -3.0964851 -2.2731562 -1.0850918  3.6170297
  1.6139234  1.4530089 -4.830279  -3.2038846]
[Training]   epsilon: 1.004742
[Training]   gamma_dih: [-6.36822   -3.4295127]
[Training]   gamma_dih: [-6.36822   -3.4295127]
[Training]   gamma_dih: [-6.36822   -3.4295127]
[Training]   gamma_dih: [-6.36822   -3.4295127]
[Training]   k_dih: [5.7923665  0.76032007]
[Training]   kr: 290.764282
[Training]   r0: 3.838547
[Training]   sigma: -3.114960
[Training]   k_dih: [5.7923665  0.76032007]
[Training]   kr: 290.764282
[Training]   k_dih: [5.7923665  0.76032007]
[Training]   kr: 290.764282
[Training]   k_dih: [5.7923665  0.76032007]
[Training]   kr: 290.764282
[Training]   r0: 3.838547
[Training]   r0: 3.838547
[Training]   sigma: -3.114960
[Training]   sigma: -3.114960
[Training]   r0: 3.838547
[Training]   sigma: -3.114960
[Training] 
============================================================
[Training] Training Stage: ADABELIEF (20 epochs, starting from 0)
[Training] ============================================================
[Training] 
============================================================
[Training] Training Stage: ADABELIEF (20 epochs, starting from 0)
[Training] ============================================================
[Training] 
============================================================
[Training] Training Stage: ADABELIEF (20 epochs, starting from 0)
[Training] ============================================================
[Training] 
============================================================
[Training] Training Stage: ADABELIEF (20 epochs, starting from 0)
[Training] ============================================================
[SLURM] Detected multi-node job: 4 tasks
[SLURM] Process 0/4
[SLURM] Coordinator: jwb0451.juwels:30315
[SLURM] CUDA_VISIBLE_DEVICES=0 -> 1 local GPUs
[Rank 0/4] JAX distributed initialized
[Rank 0] Local GPUs: 1, Total GPUs: 4
[Rank 0] CUDA_VISIBLE_DEVICES: 0
WARNING: Expected 4 local GPUs per process (1 process per node), got 1
WARNING: Expected 16 total GPUs (4 nodes × 4 GPUs), got 4
[Rank 0] Local devices: [CudaDevice(id=0)]
[Rank 0] All devices: [CudaDevice(id=0), CudaDevice(id=1), CudaDevice(id=2), CudaDevice(id=3)]
Capping edges and triplets. Beware of overflow, which is currently not being detected.
Estimated max. 3488 edges.
[Allegro] Use two atom species for oxygen and hydroge.
[Allegro] Use default mask
Use a custom scatter implementation
Out irreps 300x0e+556x1o+556x2e
Irreps after layer are 128x1o+128x2e
Use a custom scatter implementation
Out irreps 256x0e
Irreps after layer are Irreps()
[Allegro] Use two atom species for oxygen and hydroge.
[Allegro] Use default mask
[SLURM] Detected multi-node job: 4 tasks
[SLURM] Process 2/4
[SLURM] Coordinator: jwb0451.juwels:30315
[SLURM] CUDA_VISIBLE_DEVICES=0 -> 1 local GPUs
[Rank 2/4] JAX distributed initialized
[Rank 2] Local GPUs: 1, Total GPUs: 4
[Rank 2] CUDA_VISIBLE_DEVICES: 0
WARNING: Expected 4 local GPUs per process (1 process per node), got 1
WARNING: Expected 16 total GPUs (4 nodes × 4 GPUs), got 4
[Rank 2] Local devices: [CudaDevice(id=2)]
[Rank 2] All devices: [CudaDevice(id=0), CudaDevice(id=1), CudaDevice(id=2), CudaDevice(id=3)]
Capping edges and triplets. Beware of overflow, which is currently not being detected.
Estimated max. 3488 edges.
[Allegro] Use two atom species for oxygen and hydroge.
[Allegro] Use default mask
Use a custom scatter implementation
Out irreps 300x0e+556x1o+556x2e
Irreps after layer are 128x1o+128x2e
Use a custom scatter implementation
Out irreps 256x0e
Irreps after layer are Irreps()
[SLURM] Detected multi-node job: 4 tasks
[SLURM] Process 3/4
[SLURM] Coordinator: jwb0451.juwels:30315
[SLURM] CUDA_VISIBLE_DEVICES=0 -> 1 local GPUs
[Rank 3/4] JAX distributed initialized
[Rank 3] Local GPUs: 1, Total GPUs: 4
[Rank 3] CUDA_VISIBLE_DEVICES: 0
WARNING: Expected 4 local GPUs per process (1 process per node), got 1
WARNING: Expected 16 total GPUs (4 nodes × 4 GPUs), got 4
[Rank 3] Local devices: [CudaDevice(id=3)]
[Rank 3] All devices: [CudaDevice(id=0), CudaDevice(id=1), CudaDevice(id=2), CudaDevice(id=3)]
Capping edges and triplets. Beware of overflow, which is currently not being detected.
Estimated max. 3488 edges.
[Allegro] Use two atom species for oxygen and hydroge.
[Allegro] Use default mask
Use a custom scatter implementation
Out irreps 300x0e+556x1o+556x2e
Irreps after layer are 128x1o+128x2e
Use a custom scatter implementation
Out irreps 256x0e
Irreps after layer are Irreps()
[SLURM] Detected multi-node job: 4 tasks
[SLURM] Process 1/4
[SLURM] Coordinator: jwb0451.juwels:30315
[SLURM] CUDA_VISIBLE_DEVICES=0 -> 1 local GPUs
[Rank 1/4] JAX distributed initialized
[Rank 1] Local GPUs: 1, Total GPUs: 4
[Rank 1] CUDA_VISIBLE_DEVICES: 0
WARNING: Expected 4 local GPUs per process (1 process per node), got 1
WARNING: Expected 16 total GPUs (4 nodes × 4 GPUs), got 4
[Rank 1] Local devices: [CudaDevice(id=1)]
[Rank 1] All devices: [CudaDevice(id=0), CudaDevice(id=1), CudaDevice(id=2), CudaDevice(id=3)]
Capping edges and triplets. Beware of overflow, which is currently not being detected.
Estimated max. 3488 edges.
[Allegro] Use two atom species for oxygen and hydroge.
[Allegro] Use default mask
Use a custom scatter implementation
Out irreps 300x0e+556x1o+556x2e
Irreps after layer are 128x1o+128x2e
Use a custom scatter implementation
Out irreps 256x0e
Irreps after layer are Irreps()
[Allegro] Use two atom species for oxygen and hydroge.
[Allegro] Use two atom species for oxygen and hydroge.
[Allegro] Use two atom species for oxygen and hydroge.
[Allegro] Use default mask
[Allegro] Use default mask
[Allegro] Use default mask
Use a custom scatter implementation
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=float32 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
Out irreps 300x0e+556x1o+556x2e
Irreps after layer are 128x1o+128x2e
Use a custom scatter implementation
Use a custom scatter implementation
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=float32 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
Use a custom scatter implementation
Use a custom scatter implementation
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=float32 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=float32 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=float32 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
Out irreps 256x0e
Out irreps 300x0e+556x1o+556x2e
Out irreps 300x0e+556x1o+556x2e
Out irreps 300x0e+556x1o+556x2e
Irreps after layer are Irreps()
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/numpy/lax_numpy.py:183: UserWarning: Explicitly requested dtype float64 requested in asarray is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return asarray(x, dtype=self.dtype)
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/numpy/reductions.py:213: UserWarning: Explicitly requested dtype <class 'jax.numpy.float64'> requested in sum is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return _reduction(a, "sum", np.sum, lax.add, 0, preproc=_cast_to_numeric,
Irreps after layer are 128x1o+128x2e
Irreps after layer are 128x1o+128x2e
Irreps after layer are 128x1o+128x2e
Use a custom scatter implementation
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=float32 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
Use a custom scatter implementation
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=float32 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
Use a custom scatter implementation
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=float32 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
Out irreps 256x0e
Out irreps 256x0e
Out irreps 256x0e
Irreps after layer are Irreps()
Irreps after layer are Irreps()
Irreps after layer are Irreps()
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/numpy/lax_numpy.py:183: UserWarning: Explicitly requested dtype float64 requested in asarray is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return asarray(x, dtype=self.dtype)
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/numpy/lax_numpy.py:183: UserWarning: Explicitly requested dtype float64 requested in asarray is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return asarray(x, dtype=self.dtype)
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/numpy/lax_numpy.py:183: UserWarning: Explicitly requested dtype float64 requested in asarray is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return asarray(x, dtype=self.dtype)
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/numpy/reductions.py:213: UserWarning: Explicitly requested dtype <class 'jax.numpy.float64'> requested in sum is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return _reduction(a, "sum", np.sum, lax.add, 0, preproc=_cast_to_numeric,
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/numpy/reductions.py:213: UserWarning: Explicitly requested dtype <class 'jax.numpy.float64'> requested in sum is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return _reduction(a, "sum", np.sum, lax.add, 0, preproc=_cast_to_numeric,
/p/software/default/stages/2025/software/jax/0.4.34-gpsfbf-2024a-CUDA-12/lib/python3.12/site-packages/jax/_src/numpy/reductions.py:213: UserWarning: Explicitly requested dtype <class 'jax.numpy.float64'> requested in sum is not available, and will be truncated to dtype float32. To enable more dtypes, set the jax_enable_x64 configuration option or the JAX_ENABLE_X64 shell environment variable. See https://github.com/jax-ml/jax#current-gotchas for more.
  return _reduction(a, "sum", np.sum, lax.add, 0, preproc=_cast_to_numeric,
[Force] Found precomputed forces.
[Force] Found precomputed forces.
[Force] Found precomputed forces.
[Force] Found precomputed forces.
[Force] Found precomputed forces.
[Force] Found precomputed forces.
[Force] Found precomputed forces.
[Force] Found precomputed forces.
[Epoch 0]:
	Average train loss: 69.03233
	Average val loss: 50.8055419921875
	Gradient norm: 2.046363592147827
	Elapsed time = 9.920 min
	Per-target losses:
		F | train loss: 69.03232775115967 | val loss: 50.8055419921875
[Epoch 0]:
	Average train loss: 69.03233
	Average val loss: 50.8055419921875
	Gradient norm: 2.046363592147827
	Elapsed time = 9.920 min
	Per-target losses:
		F | train loss: 69.03232775115967 | val loss: 50.8055419921875
[Epoch 0]:
	Average train loss: 69.03233
	Average val loss: 50.8055419921875
	Gradient norm: 2.046363592147827
	Elapsed time = 9.920 min
	Per-target losses:
		F | train loss: 69.03232775115967 | val loss: 50.8055419921875
[Epoch 0]:
	Average train loss: 69.03233
	Average val loss: 50.8055419921875
	Gradient norm: 2.046363592147827
	Elapsed time = 9.920 min
	Per-target losses:
		F | train loss: 69.03232775115967 | val loss: 50.8055419921875




